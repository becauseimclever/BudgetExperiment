# Feature 021.5: Initial Budget Goal Creation

**Status: ğŸ”´ NOT STARTED**

## Overview

Users currently cannot create budget goals for categories that have no spending. The Budget page only displays categories with existing transactions, and the edit modal requires an existing `BudgetProgressDto` to function. This feature adds the ability to set initial budget targets for any active expense category.

## Problem Statement

### Current State

1. **Budget page** shows only categories that appear in `BudgetSummaryDto.CategoryProgress`
2. `CategoryProgress` only includes categories with transactions or existing budget goals
3. The "Edit Budget Goal" modal requires an existing `BudgetProgressDto` (from category progress)
4. **Categories page** manages categories but provides no way to set budget amounts
5. New users or users adding new categories cannot set a budget target until transactions exist

**Result:** Users must first have spending in a category before they can budget for it â€” the opposite of proactive budgeting.

### Target State

1. Users can set budget goals for **any active expense category**, even with zero transactions
2. The Budget page shows all expense categories (with or without transactions) when viewing budget goals
3. Alternatively, the Categories page allows inline or modal-based goal setting per category
4. First-time users can set up their full monthly budget before any transactions are recorded

---

## User Stories

### US-021.5-001: Set Budget for Category Without Transactions
**As a** user  
**I want to** set a monthly budget goal for a category with no transactions yet  
**So that** I can proactively plan my spending before expenses occur

**Acceptance Criteria:**
- [ ] Can create a budget goal for any active expense category
- [ ] Budget goal is immediately visible on the Budget page
- [ ] Category appears in monthly progress with $0 spent / $X budgeted

### US-021.5-002: View All Budgetable Categories
**As a** user  
**I want to** see all expense categories on the Budget page  
**So that** I know which categories still need budget targets

**Acceptance Criteria:**
- [ ] Budget page shows all active expense categories
- [ ] Categories without goals show "No Budget Set" status
- [ ] Can add/edit budget goal for any listed category

### US-021.5-003: Quick-Add Budget from Categories Page
**As a** user  
**I want to** set a budget amount when creating or editing a category  
**So that** I can manage categories and budgets in one workflow

**Acceptance Criteria:**
- [ ] Category form includes optional "Monthly Budget" field
- [ ] Setting a budget creates a goal for the current month
- [ ] Can update budget target inline on the Categories page

---

## Technical Design

### Option A: Budget Page Shows All Expense Categories (Recommended)

Modify `BudgetProgressService.GetMonthlySummaryAsync` to include all active expense categories in `CategoryProgress`, not just those with transactions or existing goals.

**Changes:**

1. **BudgetProgressService** â€” Fetch all active expense categories and merge with transaction/goal data
2. **BudgetSummaryDto.CategoryProgress** â€” Include entries with `SpentAmount = 0` and `Status = NoBudgetSet`
3. **Budget.razor** â€” Show "Add Budget" button for categories with no goal

**Pros:**
- All budgeting happens in one place (Budget page)
- Consistent with user expectation of "budget overview"
- Minimal new UI components

**Cons:**
- Budget page may get long with many categories

### Option B: Categories Page Gets Budget Management

Add budget goal creation/editing to the Categories page.

**Changes:**

1. **CategoryCard** â€” Add budget amount display and edit button
2. **CategoryForm** â€” Add optional "Monthly Budget" field
3. **New API endpoint** â€” `GET /api/v1/categories/{id}/budget?year={y}&month={m}`

**Pros:**
- Categories + budgets managed together
- Natural workflow when creating new categories

**Cons:**
- Budget management split across two pages
- More UI changes required

### Recommended Approach: Option A

Centralizing budget goal management on the Budget page is cleaner. The Categories page remains focused on category CRUD, while the Budget page handles all goal-related operations.

---

## Implementation Plan

### Phase 1: Include All Expense Categories in Budget Progress

**Objective:** Modify the backend to return all active expense categories in the budget summary.

**Tasks:**
- [ ] Update `BudgetProgressService.GetMonthlySummaryAsync` to fetch all active expense categories
- [ ] Merge categories without transactions/goals into `CategoryProgress` with zero spent
- [ ] Write unit tests for new behavior
- [ ] Verify existing tests still pass

**Commit:**
```bash
git add .
git commit -m "feat(budget): include all expense categories in budget progress

- BudgetProgressService returns all active expense categories
- Categories without transactions show as $0 spent
- Enables setting budgets for categories with no spending yet

Refs: #021.5"
```

### Phase 2: Add "Set Budget" UI for Categories Without Goals

**Objective:** Allow users to add a budget goal from the Budget page for any category.

**Tasks:**
- [ ] Update Budget.razor to show categories without goals
- [ ] Add "Set Budget" button/action for `NoBudgetSet` categories
- [ ] Reuse existing edit modal for goal creation
- [ ] Ensure modal works for both create (new goal) and edit (existing goal)

**Commit:**
```bash
git add .
git commit -m "feat(budget-ui): add budget goal creation for all categories

- Budget page shows all expense categories including those with no goals
- 'Set Budget' action available for categories without goals
- Reuses existing edit modal for goal creation

Refs: #021.5"
```

### Phase 3: Quick Budget from Category Creation (Optional Enhancement)

**Objective:** Allow setting initial budget when creating a new category.

**Tasks:**
- [ ] Add optional `InitialBudget` field to `BudgetCategoryCreateDto`
- [ ] Update category creation API to optionally create a budget goal
- [ ] Update CategoryForm component to include budget field
- [ ] Write integration tests

**Commit:**
```bash
git add .
git commit -m "feat(categories): optional budget goal on category creation

- CategoryForm includes optional monthly budget field
- Creating category with budget sets goal for current month
- Streamlines new category setup

Refs: #021.5"
```

---

## API Changes

### Modified Endpoints

| Method | Endpoint | Change |
|--------|----------|--------|
| GET | `/api/v1/budgets/summary?year={year}&month={month}` | Returns all active expense categories in `CategoryProgress` |

### New Behavior

**Before:** `CategoryProgress` only includes categories with transactions or existing budget goals.

**After:** `CategoryProgress` includes **all active expense categories**. Categories without transactions or goals have:
- `SpentAmount = 0`
- `TargetAmount = 0` (or null)
- `Status = NoBudgetSet`
- `TransactionCount = 0`

---

## UI Mockup

### Budget Page with All Categories

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Budget Overview                     â—€ January 2026 â–¶      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Monthly Summary                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ Budgeted   â”‚ Spent      â”‚ Remaining  â”‚                   â”‚
â”‚  â”‚ $2,500.00  â”‚ $1,847.32  â”‚ $652.68    â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 74%                         â”‚
â”‚  âœ“ 4 on track  âš ï¸ 1 warning  â¬š 2 no budget                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  By Category                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ” Groceries            $450 / $500    90% âš ï¸  [Edit]â”‚   â”‚
â”‚  â”‚ ğŸš— Transportation       $120 / $200    60% âœ“   [Edit]â”‚   â”‚
â”‚  â”‚ ğŸ® Entertainment        $0 / $100       0% âœ“   [Edit]â”‚   â”‚
â”‚  â”‚ ğŸ‘• Clothing             $0 / -        N/A      [Set] â”‚   â”‚ â† NEW
â”‚  â”‚ ğŸ Gifts                $0 / -        N/A      [Set] â”‚   â”‚ â† NEW
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Testing Strategy

### Unit Tests

- `BudgetProgressService` returns all active expense categories
- Categories without transactions have correct zero values
- Categories without goals have `NoBudgetSet` status
- Setting a goal for a new category works correctly

### Integration Tests

- API returns complete category list in budget summary
- Creating a budget goal via API updates summary correctly
- Deleting only goal returns category to `NoBudgetSet` status

### Manual Testing

- [ ] Create new expense category â†’ appears on Budget page with "Set Budget"
- [ ] Set budget for category with no transactions â†’ shows progress bar at 0%
- [ ] Delete budget goal â†’ category shows "No Budget Set"
- [ ] Navigate between months â†’ correct goals displayed

---

## Dependencies

- Feature 021 (Budget Categories & Goals) â€” **COMPLETED**
- No new packages required

---

## Risks & Mitigations

| Risk | Impact | Mitigation |
|------|--------|------------|
| Budget page becomes cluttered with many categories | Medium | Group by status (budgeted vs. unbudgeted), add collapse/expand |
| Performance with many categories | Low | Already loading all categories; pagination unlikely needed for typical use |
| Confusion about which page to use | Low | Clear navigation; Budget page is the primary budget management location |

---

## Success Metrics

- Users can set up a complete monthly budget before any transactions
- All expense categories visible on Budget page
- No "chicken and egg" problem for new categories
